from pwn import *
from Crypto.Util.number import *

r = remote("localhost","1234")

p = 160634950613302858781995506902938412625377360249559915379491492274326359260806831823821711441204122060415286351711411013883400510041411782176467940678464161205204391247137689678794367049197824119717278923753940984084059450704378828123780678883777306239500480793044460796256306557893061457956479624163771194201
bits = size(p)
g = 2

r.sendline("0")
gm = int(r.recv()[2:].replace("L","").rstrip("\n"), 16)
max_size = 4 + bits//4

pt = ""
try:
    cnt = 0
    while True:
        s = hex(pow(2, cnt))[2:].replace("L","")
        r.sendline(s)
        temp = r.recv().rstrip("\n")[2:].replace("L","")
        if int(temp, 16) == ((gm % p) * pow(g, int(s, 16), p)) % p:
            pt += "0"
        else:
            pt += "1"
        cnt += 1
        if cnt%8 == 0:
            print hex(int(pt[::-1], 2))[2:].replace("L","").decode("hex")
except:
    pass
print hex(int(pt[::-1], 2))[2:].replace("L","").decode("hex")
