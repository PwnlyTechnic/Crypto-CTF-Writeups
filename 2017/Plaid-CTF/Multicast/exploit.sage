from sage.all import *
from Crypto.Util.number import *

obj1 = open("data.txt","r")
data = []
for i in obj1.readlines():
    data.append(i)
for i in range(len(data)):
    data[i] = int(data[i].strip("\n"))

a = [data[i] for i in range(0,len(data),4)]
b = [data[i] for i in range(1,len(data),4)]
c = [data[i] for i in range(2,len(data),4)]
n = [data[i] for i in range(3,len(data),4)]
t = []
N = 1
for i in n:
    N *= i

# Applying Chinese Remainder Theorem
for i in n:
    t.append(crt([1,0,0,0,0],[i]+[j for j in n if j!=i]))

# Applying Coppersmith's Theorem
e = 5
gx = 0
P.<x> = PolynomialRing(Zmod(N))
for i in range(5):
    gx += t[i]*((a[i]*x+b[i])^e - c[i])
    
gx = gx.monic()
assert gx.is_monic()

list1 = gx.small_roots()
for i in list1:
    print long_to_bytes(i)
